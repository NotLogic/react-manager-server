import * as types from './type'
import http from '@/plugins/axios'
import jsCookie from 'js-cookie'
import {sysUserKey, sessionKey} from '@/libs/config'
import {deepcopy} from '@/libs/utils'
import apis from '@/apis'
import LoginPack from '@/libs/locale-provider/zh_CN/login'

// 通过使用指定的中间件，action创建函数除了返回action对象外，还可以返回函数。这时，这个action创建函数就成了thunk
// 标准的做法是使用redux-thunk中间件
// 当action创建函数返回函数时，这个函数会被(Redux  Thunk)中间件执行。这个函数并不需要保持纯净；
// 它还可以带有副作用，包括执行异步API请求。这个函数还可以dispatch action，就像dispatch前面定义的同步action一样

// 用户登录
// 先调登陆接口，拿到sessionId,设置到cookie中，然后才可以获取用户权限，后端从sessionId中获取用户信息
export const submitLogin = (loginParams, authParams) => dispatch => {
  return new Promise(function(resolve, reject){
    dispatch(isLogined({isLogining: true}))
    http(loginParams).then(res=>{
      // 缓存用户信息，设置cookie
      let { sessionId, sysUser } = res.data
      sessionStorage[sysUserKey] = JSON.stringify(sysUser)
      jsCookie.set(sessionKey,sessionId,{ path: '' })
      // 获取用户权限
      http(authParams).then(res2=>{
        let {menuList,permissionList} = res2.data
        if(!menuList.length || !permissionList.length){
          // 无权访问
          reject(LoginPack.noAuth)
        }
        dispatch(isLogined({
          isLogining: false,
          menuList,
          permissionList,
          sessionId,
          sysUser
        }))
        resolve()
      }).catch(() => {
        //  授权失败
        reject(LoginPack.getAuthError)
      })
    }).catch(()=>{
      dispatch(isLogined({
        isLogining: false,
      }))
      // 登录失败
      reject(LoginPack.error)
    })
  })
}
function isLogined ({ isLogining, sessionId, sysUser, menuList, permissionList }) {
  let action = {
    type: types.SUBMIT_LOGIN,
    menuList,
    permissionList,
    isLogining,
    sessionId,
    sysUser
  }
  return action
}

// 退出登录
export const submitLogout = () => dispatch => {
  return new Promise(function(resolve, reject){
    const {params} = apis.logout
    // 直接退出
    return resolve()
    http(params).then(res=>{
      if(res.code==1){
        dispatch(logout)
        resolve(res)
      }else{
        reject({message: '退出失败'})
      }
    }).catch(err=>reject(err))
  })
}

function logout () {
  let action = {
    type: types.LOGOUT
  }
  return action
}

// 获取权限
export const requestPermissionData = () => dispatch => {
  return new Promise(function(resolve, reject){
    const {params} = apis.getMenu
    // 设置缓存，如果缓存中有从缓存拿(生产环境中是需要刷新页面重新获取的，整个判断都是不需要的)
    if(sessionStorage.menuData){
      const result = resultPermissionData(JSON.parse(sessionStorage.menuData))
      const {
        menuData,
        permissionList
      } = result
      const res = {
        code: 1,
        data: menuData
      }
      dispatch(setMenuData(menuData))
      dispatch(setPermissionList(permissionList))
      resolve(res)
      return
    }
    // 启用测试菜单数据
    else{
      const TEST_MENU_DATA = [
        {"id":15,"permValue":"authority","parentValue":"0","permName":"权限管理","parentName":null,"permType":1,"isLeaf":0,"createTime":"2018-08-15 19:09:48","modifyTime":"2018-08-15 19:09:48"},{"id":18,"permValue":"content","parentValue":"0","permName":"资讯管理","parentName":null,"permType":1,"isLeaf":0,"createTime":"2018-08-15 19:10:58","modifyTime":"2018-08-15 19:10:58"},{"id":19,"permValue":"systemSetting","parentValue":"0","permName":"系统配置","parentName":null,"permType":1,"isLeaf":0,"createTime":"2018-08-15 19:45:58","modifyTime":"2018-08-15 19:45:58"},{"id":20,"permValue":"user","parentValue":"0","permName":"用户管理","parentName":null,"permType":1,"isLeaf":0,"createTime":"2018-08-15 19:46:12","modifyTime":"2018-08-15 19:46:12"},{"id":21,"permValue":"basiceData","parentValue":"0","permName":"基础数据","parentName":null,"permType":1,"isLeaf":0,"createTime":"2018-08-15 19:46:32","modifyTime":"2018-08-15 19:46:32"},{"id":22,"permValue":"systemUser","parentValue":"authority","permName":"系统用户","parentName":"权限管理","permType":1,"isLeaf":1,"createTime":"2018-08-15 19:47:18","modifyTime":"2018-08-15 19:47:18"},{"id":23,"permValue":"role","parentValue":"authority","permName":"系统角色","parentName":"权限管理","permType":1,"isLeaf":1,"createTime":"2018-08-15 19:47:43","modifyTime":"2018-08-15 19:47:43"},{"id":24,"permValue":"authority_index","parentValue":"authority","permName":"权限列表","parentName":"权限管理","permType":1,"isLeaf":1,"createTime":"2018-08-15 19:48:09","modifyTime":"2018-08-15 19:48:09"},{"id":25,"permValue":"ad_index","parentValue":"ad","permName":"广告管理","parentName":"广告管理","permType":1,"isLeaf":1,"createTime":"2018-08-15 19:48:40","modifyTime":"2018-08-15 19:48:40"},{"id":26,"permValue":"adviceBack_index","parentValue":"adviceBack","permName":"反馈基础数据","parentName":"意见反馈","permType":1,"isLeaf":1,"createTime":"2018-08-15 19:49:01","modifyTime":"2018-08-15 19:49:01"},{"id":28,"permValue":"adviceContent","parentValue":"adviceBack","permName":"反馈内容","parentName":"意见反馈","permType":1,"isLeaf":1,"createTime":"2018-08-15 19:49:48","modifyTime":"2018-08-15 19:49:48"},{"id":29,"permValue":"adviceBack_index:count","parentValue":"adviceBack_index","permName":"反馈统计","parentName":"意见反馈","permType":2,"isLeaf":1,"createTime":"2018-09-06 12:12:00","modifyTime":"2018-09-06 12:12:00"},{"id":30,"permValue":"softtext","parentValue":"content","permName":"资讯软文","parentName":"资讯管理","permType":1,"isLeaf":1,"createTime":"2018-08-15 19:51:40","modifyTime":"2018-08-15 19:51:40"},{"id":32,"permValue":"chickenSoup","parentValue":"content","permName":"简报心语","parentName":"资讯管理","permType":1,"isLeaf":1,"createTime":"2018-08-15 20:13:30","modifyTime":"2018-08-15 20:13:30"},{"id":33,"permValue":"easypaper","parentValue":"content","permName":"每日简报","parentName":"资讯管理","permType":1,"isLeaf":1,"createTime":"2018-08-15 20:14:02","modifyTime":"2018-08-15 20:14:02"},{"id":34,"permValue":"policy","parentValue":"guide","permName":"招商引资","parentName":"资讯管理","permType":1,"isLeaf":1,"createTime":"2018-10-10 16:44:55","modifyTime":"2018-10-10 16:44:55"},{"id":35,"permValue":"gover","parentValue":"guide","permName":"政务信息","parentName":"资讯管理","permType":1,"isLeaf":1,"createTime":"2018-10-10 16:44:58","modifyTime":"2018-10-10 16:44:58"},{"id":36,"permValue":"workClass","parentValue":"work","permName":"办事分类","parentName":"资讯管理","permType":1,"isLeaf":1,"createTime":"2018-10-10 16:42:03","modifyTime":"2018-10-10 16:42:03"},{"id":37,"permValue":"workMatter","parentValue":"work","permName":"办事事项","parentName":"资讯管理","permType":1,"isLeaf":1,"createTime":"2018-10-10 16:42:09","modifyTime":"2018-10-10 16:42:09"},{"id":38,"permValue":"article","parentValue":"systemSetting","permName":"系统通知","parentName":"系统配置","permType":1,"isLeaf":1,"createTime":"2018-08-15 20:15:54","modifyTime":"2018-08-15 20:15:54"},{"id":39,"permValue":"message","parentValue":"systemSetting","permName":"用户消息","parentName":"系统配置","permType":1,"isLeaf":1,"createTime":"2018-08-15 20:16:14","modifyTime":"2018-08-15 20:16:14"},{"id":40,"permValue":"sensitiveWords","parentValue":"systemSetting","permName":"敏感词库","parentName":"系统配置","permType":1,"isLeaf":1,"createTime":"2018-08-15 20:16:29","modifyTime":"2018-08-15 20:16:29"},{"id":41,"permValue":"appVersion","parentValue":"systemSetting","permName":"APP版本","parentName":"系统配置","permType":1,"isLeaf":1,"createTime":"2018-08-15 20:16:49","modifyTime":"2018-08-15 20:16:49"},{"id":42,"permValue":"app","parentValue":"user","permName":"APP用户","parentName":"用户管理","permType":1,"isLeaf":1,"createTime":"2018-09-05 17:19:16","modifyTime":"2018-09-05 17:19:16"},{"id":43,"permValue":"agent","parentValue":"user","permName":"代理商","parentName":"用户管理","permType":1,"isLeaf":1,"createTime":"2018-08-15 20:17:29","modifyTime":"2018-08-15 20:17:29"},{"id":44,"permValue":"province","parentValue":"basiceData","permName":"省市区","parentName":"基础数据","permType":1,"isLeaf":1,"createTime":"2018-08-15 20:17:51","modifyTime":"2018-08-15 20:17:51"},{"id":45,"permValue":"systemUser:add","parentValue":"systemUser","permName":"新增","parentName":"系统用户","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:34:38","modifyTime":"2018-08-23 12:34:38"},{"id":46,"permValue":"systemUser:edit","parentValue":"systemUser","permName":"编辑","parentName":"系统用户","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:34:50","modifyTime":"2018-08-23 12:34:50"},{"id":47,"permValue":"systemUser:delete","parentValue":"systemUser","permName":"删除","parentName":"系统用户","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:34:46","modifyTime":"2018-08-23 12:34:46"},{"id":48,"permValue":"systemUser:search","parentValue":"systemUser","permName":"搜索","parentName":"系统用户","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:34:54","modifyTime":"2018-08-23 12:34:54"},{"id":49,"permValue":"systemUser:dataGrid","parentValue":"systemUser","permName":"列表","parentName":"系统用户","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:34:41","modifyTime":"2018-08-23 12:34:41"},{"id":50,"permValue":"role:add","parentValue":"role","permName":"新增","parentName":"系统角色","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:28:55","modifyTime":"2018-08-23 12:28:55"},{"id":51,"permValue":"role:edit","parentValue":"role","permName":"编辑","parentName":"系统角色","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:29:06","modifyTime":"2018-08-23 12:29:06"},{"id":52,"permValue":"role:delete","parentValue":"role","permName":"删除","parentName":"系统角色","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:29:02","modifyTime":"2018-08-23 12:29:02"},{"id":53,"permValue":"role:search","parentValue":"role","permName":"搜索","parentName":"系统角色","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:29:10","modifyTime":"2018-08-23 12:29:10"},{"id":54,"permValue":"role:dataGrid","parentValue":"role","permName":"列表","parentName":"系统角色","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:28:58","modifyTime":"2018-08-23 12:28:58"},{"id":55,"permValue":"authority_index:add","parentValue":"authority_index","permName":"新增","parentName":"权限列表","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:31:54","modifyTime":"2018-08-23 12:31:54"},{"id":56,"permValue":"authority_index:edit","parentValue":"authority_index","permName":"编辑","parentName":"权限列表","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:32:05","modifyTime":"2018-08-23 12:32:05"},{"id":57,"permValue":"authority_index:dataGrid","parentValue":"authority_index","permName":"列表","parentName":"权限列表","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:31:58","modifyTime":"2018-08-23 12:31:58"},{"id":58,"permValue":"authority_index:delete","parentValue":"authority_index","permName":"删除","parentName":"权限列表","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:32:01","modifyTime":"2018-08-23 12:32:01"},{"id":59,"permValue":"authority_index:search","parentValue":"authority_index","permName":"搜索","parentName":"权限列表","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:32:10","modifyTime":"2018-08-23 12:32:10"},{"id":60,"permValue":"ad_index:add","parentValue":"ad_index","permName":"新增","parentName":"广告管理","permType":2,"isLeaf":1,"createTime":"2018-08-31 09:57:05","modifyTime":"2018-08-31 09:57:05"},{"id":61,"permValue":"ad_index:delete","parentValue":"ad_index","permName":"删除","parentName":"广告管理","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:30:30","modifyTime":"2018-08-23 12:30:30"},{"id":62,"permValue":"ad_index:edit","parentValue":"ad_index","permName":"编辑","parentName":"广告管理","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:30:34","modifyTime":"2018-08-23 12:30:34"},{"id":63,"permValue":"ad_index:search","parentValue":"ad_index","permName":"搜索","parentName":"广告管理","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:30:37","modifyTime":"2018-08-23 12:30:37"},{"id":64,"permValue":"ad_index:dataGrid","parentValue":"ad_index","permName":"列表","parentName":"广告管理","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:30:26","modifyTime":"2018-08-23 12:30:26"},{"id":65,"permValue":"adviceBack_index:add","parentValue":"adviceBack_index","permName":"新增","parentName":"反馈基础数","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:29:38","modifyTime":"2018-08-23 12:29:38"},{"id":66,"permValue":"adviceBack_index:delete","parentValue":"adviceBack_index","permName":"删除","parentName":"反馈基础数据","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:29:46","modifyTime":"2018-08-23 12:29:46"},{"id":67,"permValue":"adviceBack_index:edit","parentValue":"adviceBack_index","permName":"编辑","parentName":"反馈基础数据","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:29:50","modifyTime":"2018-08-23 12:29:50"},{"id":68,"permValue":"adviceBack_index:search","parentValue":"adviceBack_index","permName":"搜索","parentName":"反馈基础数据","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:29:54","modifyTime":"2018-08-23 12:29:54"},{"id":69,"permValue":"adviceBack_index:dataGrid","parentValue":"adviceBack_index","permName":"列表","parentName":"反馈基础数","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:29:42","modifyTime":"2018-08-23 12:29:42"},
        {"id":70,"permValue":"adviceContent:add","parentValue":"adviceContent","permName":"新增","parentName":"反馈内容","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:29:58","modifyTime":"2018-08-23 12:29:58"},{"id":71,"permValue":"adviceContent:delete","parentValue":"adviceContent","permName":"删除","parentName":"反馈内容","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:30:09","modifyTime":"2018-08-23 12:30:09"},{"id":72,"permValue":"adviceContent:edit","parentValue":"adviceContent","permName":"编辑","parentName":"反馈内容","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:30:14","modifyTime":"2018-08-23 12:30:14"},{"id":73,"permValue":"adviceContent:search","parentValue":"adviceContent","permName":"搜索","parentName":"反馈内容","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:30:18","modifyTime":"2018-08-23 12:30:18"},{"id":74,"permValue":"adviceContent:dataGrid","parentValue":"adviceContent","permName":"列表","parentName":"反馈内容","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:30:06","modifyTime":"2018-08-23 12:30:06"},{"id":76,"permValue":"softtext:add","parentValue":"softtext","permName":"新增","parentName":"资讯软文","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:34:14","modifyTime":"2018-08-23 12:34:14"},{"id":77,"permValue":"softtext:delete","parentValue":"softtext","permName":"删除","parentName":"资讯软文","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:34:22","modifyTime":"2018-08-23 12:34:22"},{"id":78,"permValue":"softtext:edit","parentValue":"softtext","permName":"编辑","parentName":"资讯软文","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:34:26","modifyTime":"2018-08-23 12:34:26"},{"id":79,"permValue":"softtext:search","parentValue":"softtext","permName":"搜索","parentName":"资讯软文","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:34:30","modifyTime":"2018-08-23 12:34:30"},{"id":80,"permValue":"softtext:dataGrid","parentValue":"softtext","permName":"列表","parentName":"资讯软文","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:34:17","modifyTime":"2018-08-23 12:34:17"},{"id":81,"permValue":"chickenSoup:add","parentValue":"chickenSoup","permName":"新增","parentName":"简报心语","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:32:18","modifyTime":"2018-08-23 12:32:18"},{"id":82,"permValue":"chickenSoup:delete","parentValue":"chickenSoup","permName":"删除","parentName":"简报心语","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:32:25","modifyTime":"2018-08-23 12:32:25"},{"id":83,"permValue":"chickenSoup:edit","parentValue":"chickenSoup","permName":"编辑","parentName":"简报心语","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:32:29","modifyTime":"2018-08-23 12:32:29"},{"id":84,"permValue":"chickenSoup:search","parentValue":"chickenSoup","permName":"搜索","parentName":"简报心语","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:32:33","modifyTime":"2018-08-23 12:32:33"},{"id":85,"permValue":"chickenSoup:dataGrid","parentValue":"chickenSoup","permName":"列表","parentName":"简报心语","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:32:22","modifyTime":"2018-08-23 12:32:22"},{"id":86,"permValue":"easypaper:add","parentValue":"easypaper","permName":"新增","parentName":"每日简报","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:32:48","modifyTime":"2018-08-23 12:32:48"},{"id":87,"permValue":"easypaper:edit","parentValue":"easypaper","permName":"编辑","parentName":"每日简报","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:32:55","modifyTime":"2018-08-23 12:32:55"},{"id":88,"permValue":"easypaper:delete","parentValue":"easypaper","permName":"删除","parentName":"每日简报","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:32:51","modifyTime":"2018-08-23 12:32:51"},{"id":89,"permValue":"policy:add","parentValue":"policy","permName":"新增","parentName":"招商引资","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:33:27","modifyTime":"2018-08-23 12:33:27"},{"id":90,"permValue":"policy:delete","parentValue":"policy","permName":"删除","parentName":"招商引资","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:33:34","modifyTime":"2018-08-23 12:33:34"},{"id":91,"permValue":"policy:edit","parentValue":"policy","permName":"编辑","parentName":"招商引资","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:33:38","modifyTime":"2018-08-23 12:33:38"},{"id":92,"permValue":"policy:search","parentValue":"policy","permName":"搜索","parentName":"招商引资","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:33:42","modifyTime":"2018-08-23 12:33:42"},{"id":93,"permValue":"policy:dataGrid","parentValue":"policy","permName":"列表","parentName":"招商引资","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:33:31","modifyTime":"2018-08-23 12:33:31"},{"id":94,"permValue":"gover:add","parentValue":"gover","permName":"新增","parentName":"政务信息","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:32:59","modifyTime":"2018-08-23 12:32:59"},{"id":95,"permValue":"gover:delete","parentValue":"gover","permName":"删除","parentName":"政务信息","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:33:07","modifyTime":"2018-08-23 12:33:07"},{"id":96,"permValue":"gover:edit","parentValue":"gover","permName":"编辑","parentName":"政务信息","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:33:10","modifyTime":"2018-08-23 12:33:10"},{"id":97,"permValue":"gover:search","parentValue":"gover","permName":"搜索","parentName":"政务信息","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:33:14","modifyTime":"2018-08-23 12:33:14"},{"id":98,"permValue":"gover:dataGrid","parentValue":"gover","permName":"列表","parentName":"政务信息","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:33:02","modifyTime":"2018-08-23 12:33:02"},{"id":99,"permValue":"workClass:add","parentValue":"workClass","permName":"新增","parentName":"办事分类","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:35:06","modifyTime":"2018-08-23 12:35:06"},{"id":100,"permValue":"workClass:delete","parentValue":"workClass","permName":"删除","parentName":"办事分类","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:35:13","modifyTime":"2018-08-23 12:35:13"},{"id":101,"permValue":"workClass:edit","parentValue":"workClass","permName":"编辑","parentName":"办事分类","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:35:17","modifyTime":"2018-08-23 12:35:17"},{"id":102,"permValue":"workClass:search","parentValue":"workClass","permName":"搜索","parentName":"办事分类","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:35:21","modifyTime":"2018-08-23 12:35:21"},{"id":103,"permValue":"workClass:dataGrid","parentValue":"workClass","permName":"列表","parentName":"办事分类","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:35:10","modifyTime":"2018-08-23 12:35:10"},{"id":104,"permValue":"workMatter:add","parentValue":"workMatter","permName":"新增","parentName":"办事事项","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:35:25","modifyTime":"2018-08-23 12:35:25"},{"id":105,"permValue":"workMatter:delete","parentValue":"workMatter","permName":"删除","parentName":"办事事项","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:35:40","modifyTime":"2018-08-23 12:35:40"},{"id":106,"permValue":"workMatter:edit","parentValue":"workMatter","permName":"编辑","parentName":"办事事项","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:35:46","modifyTime":"2018-08-23 12:35:46"},{"id":107,"permValue":"workMatter:search","parentValue":"workMatter","permName":"搜索","parentName":"办事事项","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:35:52","modifyTime":"2018-08-23 12:35:52"},{"id":108,"permValue":"workMatter:dataGrid","parentValue":"workMatter","permName":"列表","parentName":"办事事项","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:35:32","modifyTime":"2018-08-23 12:35:32"},{"id":109,"permValue":"article:add","parentValue":"article","permName":"新增","parentName":"系统通知","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:31:29","modifyTime":"2018-08-23 12:31:29"},{"id":110,"permValue":"article:delete","parentValue":"article","permName":"删除","parentName":"系统通知","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:31:38","modifyTime":"2018-08-23 12:31:38"},{"id":111,"permValue":"article:edit","parentValue":"article","permName":"编辑","parentName":"系统通知","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:31:44","modifyTime":"2018-08-23 12:31:44"},{"id":112,"permValue":"article:search","parentValue":"article","permName":"搜索","parentName":"系统通知","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:31:48","modifyTime":"2018-08-23 12:31:48"},{"id":113,"permValue":"article:dataGrid","parentValue":"article","permName":"列表","parentName":"系统通知","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:31:33","modifyTime":"2018-08-23 12:31:33"},{"id":114,"permValue":"message:dataGrid","parentValue":"message","permName":"列表","parentName":"用户消息","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:33:22","modifyTime":"2018-08-23 12:33:22"},{"id":115,"permValue":"sensitiveWords:add","parentValue":"sensitiveWords","permName":"新增","parentName":"敏感词库","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:29:14","modifyTime":"2018-08-23 12:29:14"},{"id":116,"permValue":"sensitiveWords:delete","parentValue":"sensitiveWords","permName":"删除","parentName":"敏感词库","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:29:28","modifyTime":"2018-08-23 12:29:28"},{"id":117,"permValue":"sensitiveWords:edit","parentValue":"sensitiveWords","permName":"编辑","parentName":"敏感词库","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:34:07","modifyTime":"2018-08-23 12:34:07"},{"id":118,"permValue":"sensitiveWords:search","parentValue":"sensitiveWords","permName":"搜索","parentName":"敏感词库","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:34:10","modifyTime":"2018-08-23 12:34:10"},{"id":119,"permValue":"sensitiveWords:dataGrid","parentValue":"sensitiveWords","permName":"列表","parentName":"敏感词库","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:29:24","modifyTime":"2018-08-23 12:29:24"},
        {"id":120,"permValue":"appVersion:add","parentValue":"appVersion","permName":"新增","parentName":"APP版本","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:31:13","modifyTime":"2018-08-23 12:31:13"},{"id":121,"permValue":"appVersion:delete","parentValue":"appVersion","permName":"删除","parentName":"APP版本","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:31:21","modifyTime":"2018-08-23 12:31:21"},{"id":122,"permValue":"appVersion:edit","parentValue":"appVersion","permName":"编辑","parentName":"APP版本","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:31:25","modifyTime":"2018-08-23 12:31:25"},{"id":123,"permValue":"appVersion:dataGrid","parentValue":"appVersion","permName":"列表","parentName":"APP版本","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:31:17","modifyTime":"2018-08-23 12:31:17"},{"id":127,"permValue":"app:search","parentValue":"app","permName":"搜索","parentName":"APP用户","permType":2,"isLeaf":1,"createTime":"2018-09-05 17:19:49","modifyTime":"2018-09-05 17:19:49"},{"id":128,"permValue":"app:dataGrid","parentValue":"app","permName":"列表","parentName":"APP用户","permType":2,"isLeaf":1,"createTime":"2018-09-05 17:20:05","modifyTime":"2018-09-05 17:20:05"},{"id":129,"permValue":"agent:add","parentValue":"agent","permName":"新增","parentName":"代理商","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:30:45","modifyTime":"2018-08-23 12:30:45"},{"id":130,"permValue":"agent:delete","parentValue":"agent","permName":"删除","parentName":"代理商","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:30:54","modifyTime":"2018-08-23 12:30:54"},{"id":131,"permValue":"agent:edit","parentValue":"agent","permName":"编辑","parentName":"代理商","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:30:57","modifyTime":"2018-08-23 12:30:57"},{"id":132,"permValue":"agent:dataGrid","parentValue":"agent","permName":"列表","parentName":"代理商","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:30:50","modifyTime":"2018-08-23 12:30:50"},{"id":133,"permValue":"province:dataGrid","parentValue":"province","permName":"列表","parentName":"省市区","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:33:46","modifyTime":"2018-08-23 12:33:46"},{"id":134,"permValue":"report","parentValue":"0","permName":"举报管理","parentName":null,"permType":1,"isLeaf":0,"createTime":"2018-08-31 11:27:05","modifyTime":"2018-08-31 11:27:05"},{"id":135,"permValue":"report_index","parentValue":"report","permName":"举报基础信息","parentName":"举报管理","permType":1,"isLeaf":1,"createTime":"2018-08-23 12:17:59","modifyTime":"2018-08-23 12:17:59"},{"id":136,"permValue":"report_index:add","parentValue":"report_index","permName":"新增","parentName":"举报基础信息","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:28:35","modifyTime":"2018-08-23 12:28:35"},{"id":137,"permValue":"report_index:delete","parentValue":"report_index","permName":"删除","parentName":"举报基础信息","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:28:43","modifyTime":"2018-08-23 12:28:43"},{"id":138,"permValue":"report_index:edit","parentValue":"report_index","permName":"编辑","parentName":"举报基础信息","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:28:47","modifyTime":"2018-08-23 12:28:47"},{"id":139,"permValue":"report_index:dataGrid","parentValue":"report_index","permName":"列表","parentName":"举报基础信息","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:28:40","modifyTime":"2018-08-23 12:28:40"},{"id":140,"permValue":"reportClass","parentValue":"report","permName":"举报分类","parentName":"举报管理","permType":1,"isLeaf":1,"createTime":"2018-08-23 12:24:50","modifyTime":"2018-08-23 12:24:50"},{"id":141,"permValue":"userReport","parentValue":"report","permName":"用户举报","parentName":"举报管理","permType":1,"isLeaf":1,"createTime":"2018-08-23 12:25:09","modifyTime":"2018-08-23 12:25:09"},{"id":142,"permValue":"reportClass:add","parentValue":"reportClass","permName":"新增","parentName":"举报分类","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:25:40","modifyTime":"2018-08-23 12:25:40"},{"id":143,"permValue":"reportClass:delete","parentValue":"reportClass","permName":"删除","parentName":"举报分类","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:26:04","modifyTime":"2018-08-23 12:26:04"},{"id":144,"permValue":"reportClass:edit","parentValue":"reportClass","permName":"编辑","parentName":"举报分类","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:26:33","modifyTime":"2018-08-23 12:26:33"},{"id":145,"permValue":"reportClass:dataGrid","parentValue":"reportClass","permName":"列表","parentName":"举报分类","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:26:50","modifyTime":"2018-08-23 12:26:50"},{"id":146,"permValue":"userReport:add","parentValue":"userReport","permName":"新增","parentName":"用户举报","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:27:10","modifyTime":"2018-08-23 12:27:10"},{"id":147,"permValue":"userReport:delete","parentValue":"userReport","permName":"删除","parentName":"用户举报","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:27:25","modifyTime":"2018-08-23 12:27:25"},{"id":148,"permValue":"userReport:edit","parentValue":"userReport","permName":"编辑","parentName":"用户举报","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:27:46","modifyTime":"2018-08-23 12:27:46"},{"id":149,"permValue":"userReport:dataGrid","parentValue":"userReport","permName":"列表","parentName":"用户举报","permType":2,"isLeaf":1,"createTime":"2018-08-23 12:28:06","modifyTime":"2018-08-23 12:28:06"},{"id":150,"permValue":"easypaper:dataGrid","parentValue":"easypaper","permName":"列表","parentName":"每日简报","permType":2,"isLeaf":1,"createTime":"2018-08-23 16:56:46","modifyTime":"2018-08-23 16:56:46"},{"id":151,"permValue":"systemUser:role","parentValue":"systemUser","permName":"角色","parentName":"系统角色","permType":2,"isLeaf":1,"createTime":"2018-08-23 17:03:31","modifyTime":"2018-08-23 17:03:31"},{"id":152,"permValue":"role:perm","parentValue":"role","permName":"权限","parentName":"系统角色","permType":2,"isLeaf":1,"createTime":"2018-08-23 17:18:42","modifyTime":"2018-08-23 17:18:42"},{"id":153,"permValue":"softtext:publish","parentValue":"softtext","permName":"发布","parentName":"资讯软文","permType":2,"isLeaf":1,"createTime":"2018-08-24 10:16:26","modifyTime":"2018-08-24 10:16:26"},{"id":154,"permValue":"softtext:preview","parentValue":"softtext","permName":"预览","parentName":"资讯软文","permType":2,"isLeaf":1,"createTime":"2018-08-24 10:22:14","modifyTime":"2018-08-24 10:22:14"},{"id":155,"permValue":"easypaper:preview","parentValue":"easypaper","permName":"预览","parentName":"每日简报","permType":2,"isLeaf":1,"createTime":"2018-08-24 10:26:05","modifyTime":"2018-08-24 10:26:05"},{"id":156,"permValue":"workMatter:preview","parentValue":"workMatter","permName":"预览","parentName":"办事事项","permType":2,"isLeaf":1,"createTime":"2018-08-24 10:27:43","modifyTime":"2018-08-24 10:27:43"},{"id":157,"permValue":"policy:preview","parentValue":"policy","permName":"预览","parentName":"招商引资","permType":2,"isLeaf":1,"createTime":"2018-08-24 10:29:17","modifyTime":"2018-08-24 10:29:17"},{"id":158,"permValue":"gover:preview","parentValue":"gover","permName":"预览","parentName":"政务信息","permType":2,"isLeaf":1,"createTime":"2018-08-24 10:29:42","modifyTime":"2018-08-24 10:29:42"},{"id":159,"permValue":"sensitiveWords:import","parentValue":"sensitiveWords","permName":"导入","parentName":"敏感词库","permType":2,"isLeaf":1,"createTime":"2018-08-24 10:32:47","modifyTime":"2018-08-24 10:32:47"},{"id":161,"permValue":"message:dataGrid","parentValue":"app","permName":"查看消息","parentName":"APP用户","permType":2,"isLeaf":1,"createTime":"2018-09-06 12:31:07","modifyTime":"2018-09-06 12:31:07"},{"id":162,"permValue":"app:operation","parentValue":"app","permName":"查看app用户相关","parentName":"APP用户","permType":2,"isLeaf":1,"createTime":"2018-09-05 17:20:12","modifyTime":"2018-09-05 17:20:12"},{"id":163,"permValue":"province:add","parentValue":"province","permName":"新增","parentName":"省市区","permType":2,"isLeaf":1,"createTime":"2018-08-24 10:56:40","modifyTime":"2018-08-24 10:56:40"},{"id":164,"permValue":"province:delete","parentValue":"province","permName":"删除","parentName":"省市区","permType":2,"isLeaf":1,"createTime":"2018-08-24 10:57:01","modifyTime":"2018-08-24 10:57:01"},{"id":165,"permValue":"province:edit","parentValue":"province","permName":"编辑","parentName":"省市区","permType":2,"isLeaf":1,"createTime":"2018-08-24 10:57:21","modifyTime":"2018-08-24 10:57:21"},{"id":166,"permValue":"province:check","parentValue":"province","permName":"校验","parentName":"省市区","permType":2,"isLeaf":1,"createTime":"2018-08-24 10:59:57","modifyTime":"2018-08-24 10:59:57"},{"id":167,"permValue":"chickenSoup:classify","parentValue":"chickenSoup","permName":"分类","parentName":"简报心语","permType":2,"isLeaf":1,"createTime":"2018-08-24 15:17:07","modifyTime":"2018-08-24 15:17:07"},{"id":168,"permValue":"app:preview","parentValue":"app","permName":"预览","parentName":"APP用户","permType":2,"isLeaf":1,"createTime":"2018-09-05 17:20:15","modifyTime":"2018-09-05 17:20:15"},{"id":170,"permValue":"test","parentValue":"template","permName":"测试","parentName":"模板/测试","permType":1,"isLeaf":1,"createTime":"2018-08-29 14:33:11","modifyTime":"2018-08-29 14:33:11"},{"id":171,"permValue":"template_index","parentValue":"template","permName":"模板","parentName":"模板/测试","permType":1,"isLeaf":1,"createTime":"2018-08-29 14:33:32","modifyTime":"2018-08-29 14:33:32"},{"id":172,"permValue":"test:dataGrid","parentValue":"test","permName":"列表","parentName":"测试","permType":2,"isLeaf":1,"createTime":"2018-08-29 14:34:20","modifyTime":"2018-08-29 14:34:20"},{"id":173,"permValue":"template_index:dataGrid","parentValue":"template_index","permName":"列表","parentName":"模板","permType":2,"isLeaf":1,"createTime":"2018-08-29 14:34:46","modifyTime":"2018-08-29 14:34:46"},{"id":174,"permValue":"post","parentValue":"0","permName":"动态管理","parentName":null,"permType":1,"isLeaf":0,"createTime":"2018-10-11 12:18:04","modifyTime":"2018-10-11 12:18:04"},{"id":175,"permValue":"post_index:add","parentValue":"post_index","permName":"新增","parentName":"动态管理","permType":2,"isLeaf":1,"createTime":"2018-10-11 12:09:11","modifyTime":"2018-10-11 12:09:11"},
        {"id":176,"permValue":"post_index:dataGrid","parentValue":"post_index","permName":"列表","parentName":"动态管理","permType":2,"isLeaf":1,"createTime":"2018-10-11 12:07:37","modifyTime":"2018-10-11 12:07:37"},{"id":177,"permValue":"post_index:search","parentValue":"post_index","permName":"搜索","parentName":"动态管理","permType":2,"isLeaf":1,"createTime":"2018-10-11 12:07:32","modifyTime":"2018-10-11 12:07:32"},{"id":178,"permValue":"post_index:edit","parentValue":"post_index","permName":"修改","parentName":"动态管理","permType":2,"isLeaf":1,"createTime":"2018-10-11 12:07:28","modifyTime":"2018-10-11 12:07:28"},{"id":179,"permValue":"post_index:delete","parentValue":"post_index","permName":"删除","parentName":"动态管理","permType":2,"isLeaf":1,"createTime":"2018-10-11 12:07:23","modifyTime":"2018-10-11 12:07:23"},{"id":180,"permValue":"post_index","parentValue":"post","permName":"动态管理","parentName":"所有动态","permType":1,"isLeaf":1,"createTime":"2018-10-11 12:07:11","modifyTime":"2018-10-11 12:07:11"},{"id":181,"permValue":"ad_index:clearCache","parentValue":"ad_index","permName":"清除缓存","parentName":"广告管理","permType":2,"isLeaf":1,"createTime":"2018-09-03 11:53:30","modifyTime":"2018-09-03 11:53:30"},{"id":182,"permValue":"gover:clearCache","parentValue":"gover","permName":"清除缓存","parentName":"政务管理","permType":2,"isLeaf":1,"createTime":"2018-09-03 11:54:38","modifyTime":"2018-09-03 11:54:38"},{"id":183,"permValue":"policy:clearCache","parentValue":"policy","permName":"清除缓存","parentName":"招商","permType":2,"isLeaf":1,"createTime":"2018-09-03 11:55:15","modifyTime":"2018-09-03 11:55:15"},{"id":184,"permValue":"softtext:clearCache","parentValue":"softtext","permName":"清除缓存","parentName":"软文管理","permType":2,"isLeaf":1,"createTime":"2018-09-03 11:55:49","modifyTime":"2018-09-03 11:55:49"},{"id":185,"permValue":"agent:clearCache","parentValue":"agent","permName":"清除缓存","parentName":"代理商","permType":2,"isLeaf":1,"createTime":"2018-09-03 11:57:33","modifyTime":"2018-09-03 11:57:33"},{"id":186,"permValue":"workClass:clearCache","parentValue":"workClass","permName":"清除缓存","parentName":"办事分类","permType":2,"isLeaf":1,"createTime":"2018-09-03 11:58:00","modifyTime":"2018-09-03 11:58:00"},{"id":187,"permValue":"workMatter:clearCache","parentValue":"workMatter","permName":"清除缓存","parentName":"办事事项","permType":2,"isLeaf":1,"createTime":"2018-09-03 11:58:34","modifyTime":"2018-09-03 11:58:34"},{"id":190,"permValue":"hometown:dataGrid","parentValue":"hometown","permName":"列表","parentName":"用户家乡分布","permType":2,"isLeaf":1,"createTime":"2018-09-05 12:13:31","modifyTime":"2018-09-05 12:13:31"},{"id":191,"permValue":"postUser","parentValue":"user","permName":"WEB用户","parentName":"用户管理","permType":1,"isLeaf":1,"createTime":"2018-09-05 15:35:18","modifyTime":"2018-09-05 15:35:18"},{"id":192,"permValue":"app:dataGrid","parentValue":"postUser","permName":"列表","parentName":"WEB用户","permType":2,"isLeaf":1,"createTime":"2018-09-06 09:51:23","modifyTime":"2018-09-06 09:51:23"},{"id":193,"permValue":"app:add","parentValue":"postUser","permName":"新增WEB用户","parentName":"WEB用户","permType":2,"isLeaf":1,"createTime":"2018-09-06 10:54:29","modifyTime":"2018-09-06 10:54:29"},{"id":194,"permValue":"app:postDelete","parentValue":"postUser","permName":"删除","parentName":"WEB用户","permType":2,"isLeaf":1,"createTime":"2019-01-03 18:10:25","modifyTime":"2019-01-03 18:10:25"},{"id":195,"permValue":"app:edit","parentValue":"postUser","permName":"编辑","parentName":"WEB用户","permType":2,"isLeaf":1,"createTime":"2018-09-06 10:51:08","modifyTime":"2018-09-06 10:51:08"},{"id":196,"permValue":"app:search","parentValue":"postUser","permName":"搜索","parentName":"WEB用户","permType":2,"isLeaf":1,"createTime":"2018-09-06 10:51:01","modifyTime":"2018-09-06 10:51:01"},{"id":197,"permValue":"post_index:add","parentValue":"postUser","permName":"发帖","parentName":"WEB用户","permType":2,"isLeaf":1,"createTime":"2018-09-05 17:12:42","modifyTime":"2018-09-05 17:12:42"},{"id":199,"permValue":"hometown","parentValue":"count","permName":"用户家乡分布","parentName":"统计","permType":1,"isLeaf":1,"createTime":"2018-09-06 11:12:00","modifyTime":"2018-09-06 11:12:00"},{"id":201,"permValue":"count","parentValue":"0","permName":"统计","parentName":null,"permType":1,"isLeaf":0,"createTime":"2018-09-06 11:21:55","modifyTime":"2018-09-06 11:21:55"},{"id":202,"permValue":"message:dataGrid","parentValue":"postUser","permName":"消息","parentName":"WEB用户","permType":2,"isLeaf":1,"createTime":"2018-09-06 12:32:34","modifyTime":"2018-09-06 12:32:34"},{"id":203,"permValue":"workMatter:import","parentValue":"workMatter","permName":"导入办事事项","parentName":"办事事项","permType":2,"isLeaf":1,"createTime":"2018-09-26 14:33:27","modifyTime":"2018-09-26 14:33:27"},{"id":204,"permValue":"work","parentValue":null,"permName":"办事管理","parentName":null,"permType":1,"isLeaf":0,"createTime":"2018-10-10 16:44:00","modifyTime":"2018-10-10 16:44:00"},{"id":205,"permValue":"guide","parentValue":null,"permName":"政务管理","parentName":null,"permType":1,"isLeaf":0,"createTime":"2018-10-10 16:44:39","modifyTime":"2018-10-10 16:44:39"},{"id":206,"permValue":"template","parentValue":null,"permName":"模板/测试","parentName":null,"permType":1,"isLeaf":0,"createTime":"2018-10-10 16:45:50","modifyTime":"2018-10-10 16:45:50"},{"id":207,"permValue":"ad","parentValue":null,"permName":"广告管理","parentName":null,"permType":1,"isLeaf":0,"createTime":"2018-10-10 17:53:43","modifyTime":"2018-10-10 17:53:43"},{"id":208,"permValue":"adviceBack","parentValue":null,"permName":"意见反馈","parentName":null,"permType":1,"isLeaf":0,"createTime":"2018-10-10 17:54:02","modifyTime":"2018-10-10 17:54:02"},{"id":209,"permValue":"service","parentValue":null,"permName":"服务","parentName":null,"permType":1,"isLeaf":0,"createTime":"2018-10-12 09:53:03","modifyTime":"2018-10-12 09:53:03"},{"id":210,"permValue":"serviceNumber","parentValue":"service","permName":"服务","parentName":"服务","permType":1,"isLeaf":1,"createTime":"2018-10-12 10:46:33","modifyTime":"2018-10-12 10:46:33"},{"id":211,"permValue":"serviceNumber:dataGrid","parentValue":"serviceNumber","permName":"列表","parentName":"服务","permType":2,"isLeaf":1,"createTime":"2018-10-12 10:46:37","modifyTime":"2018-10-12 10:46:37"},{"id":212,"permValue":"serviceNumber:add","parentValue":"serviceNumber","permName":"新增","parentName":"服务","permType":2,"isLeaf":1,"createTime":"2018-10-12 10:46:40","modifyTime":"2018-10-12 10:46:40"},{"id":213,"permValue":"serviceNumber:edit","parentValue":"serviceNumber","permName":"编辑","parentName":"服务","permType":2,"isLeaf":1,"createTime":"2018-10-12 10:46:44","modifyTime":"2018-10-12 10:46:44"},{"id":214,"permValue":"serviceNumber:delete","parentValue":"serviceNumber","permName":"删除","parentName":"服务","permType":2,"isLeaf":1,"createTime":"2018-10-12 10:46:47","modifyTime":"2018-10-12 10:46:47"},{"id":215,"permValue":"serviceNumber:search","parentValue":"serviceNumber","permName":"搜索","parentName":"服务","permType":2,"isLeaf":1,"createTime":"2018-10-12 10:46:26","modifyTime":"2018-10-12 10:46:26"},{"id":216,"permValue":"serviceNumber:preview","parentValue":"serviceNumber","permName":"查看投稿","parentName":"服务","permType":2,"isLeaf":1,"createTime":"2018-10-15 15:42:23","modifyTime":"2018-10-15 15:42:23"},{"id":217,"permValue":"serviceNumber:submission","parentValue":"serviceNumber","permName":"投稿","parentName":"服务","permType":2,"isLeaf":1,"createTime":"2018-10-15 15:48:47","modifyTime":"2018-10-15 15:48:47"},{"id":221,"permValue":"serviceClassify","parentValue":"service","permName":"服务分类","parentName":"服务","permType":1,"isLeaf":1,"createTime":"2018-10-22 14:19:36","modifyTime":"2018-10-22 14:19:36"},{"id":222,"permValue":"serviceClassify:add","parentValue":"serviceClassify","permName":"新增","parentName":"服务分类","permType":2,"isLeaf":1,"createTime":"2018-10-22 14:17:51","modifyTime":"2018-10-22 14:17:51"},{"id":223,"permValue":"serviceClassify:edit","parentValue":"serviceClassify","permName":"编辑","parentName":"服务分类","permType":2,"isLeaf":1,"createTime":"2018-10-22 14:18:11","modifyTime":"2018-10-22 14:18:11"},{"id":224,"permValue":"serviceClassify:delete","parentValue":"serviceClassify","permName":"删除","parentName":"服务分类","permType":2,"isLeaf":1,"createTime":"2018-10-22 14:18:26","modifyTime":"2018-10-22 14:18:26"},{"id":225,"permValue":"serviceClassify:dataGrid","parentValue":"serviceClassify","permName":"列表","parentName":"服务分类","permType":2,"isLeaf":1,"createTime":"2018-10-22 14:18:45","modifyTime":"2018-10-22 14:18:45"},{"id":226,"permValue":"serviceClassify:search","parentValue":"serviceClassify","permName":"搜索","parentName":"服务分类","permType":2,"isLeaf":1,"createTime":"2018-10-22 17:23:34","modifyTime":"2018-10-22 17:23:34"},{"id":227,"permValue":"submission","parentValue":"service","permName":"投稿","parentName":"服务","permType":1,"isLeaf":1,"createTime":"2018-10-23 09:43:15","modifyTime":"2018-10-23 09:43:15"},{"id":228,"permValue":"submission:add","parentValue":"submission","permName":"新增","parentName":"投稿","permType":2,"isLeaf":1,"createTime":"2018-10-23 09:45:29","modifyTime":"2018-10-23 09:45:29"},{"id":229,"permValue":"submission:delete","parentValue":"submission","permName":"删除","parentName":"投稿","permType":2,"isLeaf":1,"createTime":"2018-10-23 09:45:48","modifyTime":"2018-10-23 09:45:48"},{"id":230,"permValue":"submission:edit","parentValue":"submission","permName":"编辑","parentName":"投稿","permType":2,"isLeaf":1,"createTime":"2018-10-23 09:46:00","modifyTime":"2018-10-23 09:46:00"},{"id":231,"permValue":"submission:dataGrid","parentValue":"submission","permName":"列表","parentName":"投稿","permType":2,"isLeaf":1,"createTime":"2018-10-23 09:46:27","modifyTime":"2018-10-23 09:46:27"},{"id":232,"permValue":"submission:search","parentValue":"submission","permName":"搜索","parentName":"投稿","permType":2,"isLeaf":1,"createTime":"2018-10-23 09:47:06","modifyTime":"2018-10-23 09:47:06"},
        {"id":233,"permValue":"submission:examine","parentValue":"submission","permName":"审核","parentName":"投稿","permType":2,"isLeaf":1,"createTime":"2018-10-23 14:46:50","modifyTime":"2018-10-23 14:46:50"},{"id":234,"permValue":"submission:push","parentValue":"submission","permName":"推送","parentName":"投稿","permType":2,"isLeaf":1,"createTime":"2018-10-23 18:10:18","modifyTime":"2018-10-23 18:10:18"},{"id":235,"permValue":"serviceNumber:push","parentValue":"serviceNumber","permName":"推送","parentName":"投稿","permType":2,"isLeaf":1,"createTime":"2018-10-24 15:02:36","modifyTime":"2018-10-24 15:02:36"},{"id":236,"permValue":"userCount","parentValue":"count","permName":"用户统计","parentName":"统计","permType":1,"isLeaf":1,"createTime":"2019-01-03 18:04:14","modifyTime":"2019-01-03 18:04:14"},{"id":237,"permValue":"userCount:dataGrid","parentValue":"userCount","permName":"列表","parentName":"用户统计","permType":2,"isLeaf":1,"createTime":"2019-01-03 18:04:39","modifyTime":"2019-01-03 18:04:39"},{"id":238,"permValue":"userSubmission","parentValue":"service","permName":"用户投稿","parentName":"服务","permType":1,"isLeaf":1,"createTime":"2019-01-03 18:05:11","modifyTime":"2019-01-03 18:05:11"},{"id":239,"permValue":"userSubmission:add","parentValue":"userSubmission","permName":"新增","parentName":"用户投稿","permType":2,"isLeaf":1,"createTime":"2019-01-03 18:06:08","modifyTime":"2019-01-03 18:06:08"},{"id":240,"permValue":"userSubmission:edit","parentValue":"userSubmission","permName":"编辑","parentName":"用户投稿","permType":2,"isLeaf":1,"createTime":"2019-01-03 18:06:24","modifyTime":"2019-01-03 18:06:24"},{"id":241,"permValue":"userSubmission:delete","parentValue":"userSubmission","permName":"删除","parentName":"用户投稿","permType":2,"isLeaf":1,"createTime":"2019-01-03 18:06:39","modifyTime":"2019-01-03 18:06:39"},{"id":242,"permValue":"userSubmission:search","parentValue":"userSubmission","permName":"搜索","parentName":"用户投稿","permType":2,"isLeaf":1,"createTime":"2019-01-03 18:06:58","modifyTime":"2019-01-03 18:06:58"},{"id":243,"permValue":"userSubmission:dataGrid","parentValue":"userSubmission","permName":"列表","parentName":"用户投稿","permType":2,"isLeaf":1,"createTime":"2019-01-03 18:07:16","modifyTime":"2019-01-03 18:07:16"},{"id":244,"permValue":"userSubmission:push","parentValue":"userSubmission","permName":"推送","parentName":"用户投稿","permType":2,"isLeaf":1,"createTime":"2019-01-03 18:07:34","modifyTime":"2019-01-03 18:07:34"},{"id":245,"permValue":"app:delete","parentValue":"app","permName":"删除","parentName":"APP用户","permType":2,"isLeaf":1,"createTime":"2019-01-03 18:11:03","modifyTime":"2019-01-03 18:11:03"}
      ]
      const result = resultPermissionData(TEST_MENU_DATA)
      const {
        menuData,
        permissionList
      } = result
      const res = {
        code: 1,
        data: menuData
      }
      dispatch(setMenuData(menuData))
      dispatch(setPermissionList(permissionList))
      resolve(res)
      return
    }    
    http(params).then(res=>{
      if(res.code==1){
        const result = resultPermissionData(res.data)
        const {
          menuData,
          permissionList
        } = result
        sessionStorage.menuData = JSON.stringify(menuData)
        dispatch(setMenuData(menuData))
        dispatch(setPermissionList(permissionList))
        resolve(res)
      }
    }).catch(err=>reject(err))
  })
}
function resultPermissionData (data) {
  let menuData=[],childrenMenuData=[],permissionList=[]
  data.forEach(item=>{
    // permTypeMap: { 
    //   1: '菜单',
    //   2: '按钮',
    //   3: '接口',
    //   4: '特殊',
    // },
    // 是否子节点
    // isLeafMap: {
    //   '0': '不是',
    //   '1': '是'
    // },
    let _item = deepcopy(item)
    let { permType, isLeaf, permValue } = item
    // 筛选所有的菜单： permType=1 的；isLeaf=0父菜单，isLeaf=1子菜单
    // 筛选所有的按钮： permType=2 的；所有的isLeaf=1
    if(permType==1){
      if(isLeaf==0){
        _item.children = []
        menuData.push(_item)
      }else if(isLeaf==1){
        childrenMenuData.push(_item)
      }
    }else //  非菜单的权限
    // if(permType==2)  // 所有按钮的权限
    {      
      permissionList.push(permValue)
    }
  })
  childrenMenuData.forEach(child=>{
    menuData.forEach(parent=>{
      if(child.parentValue == parent.permValue){
        parent.children.push(child)
      }
    })
  })
  return {
    menuData,
    permissionList
  }
}
function setMenuData(data=[]) {
  let action = {
    type: types.SET_MENU_DATA,
    menuData: data
  }
  return action
}

function setPermissionList(data=[]){
  let action = {
    type: types.SET_PERMISSION_LIST,
    permissionList: data
  }
  return action
}

export default {

}